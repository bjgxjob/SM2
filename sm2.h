#include <stdio.h>
#include <stdlib.h>
#include <openssl/ec.h>
#include <openssl/rand.h>
#include <openssl/bn.h>
#include <openssl/ecdsa.h>
#include <openssl/ecdh.h>
#include <memory.h>
#include <openssl/evp.h>
#include "sm3.h"
//#include <openssl/ec/ec_lcl.h>

static void showBN(BIGNUM *bn)
{
	char *p = NULL;
	p = BN_bn2hex(bn);
	printf("%s\n", p);
	OPENSSL_free(p);
}

char *sm2_param_fp_256[] = {
	//示例2：Fp-256曲线 
	//素数p： 
	"8542D69E" "4C044F18" "E8B92435" "BF6FF7DE" "45728391" "5C45517D" "722EDB8B" "08F1DFC3",
	//系数a： 
	"787968B4" "FA32C3FD" "2417842E" "73BBFEFF" "2F3C848B" "6831D7E0" "EC65228B" "3937E498",
	//系数b： 
	"63E4C6D3" "B23B0C84" "9CF84241" "484BFE48" "F61D59A5" "B16BA06E" "6E12D1DA" "27C5249A",
	//基点G = (x;y)，其阶记为n。 
	//坐标x： 
	"421DEBD6" "1B62EAB6" "746434EB" "C3CC315E" "32220B3B" "ADD50BDC" "4C4E6C14" "7FEDD43D",
	//坐标y： 
	"0680512B" "CBB42C07" "D47349D2" "153B70C4" "E5D7FDFC" "BFA36EA1" "A85841B9" "E46E09A2",
	//阶n： 
	"8542D69E" "4C044F18" "E8B92435" "BF6FF7DD" "29772063" "0485628D" "5AE74EE7" "C32E79B7",
};

char *sm2_param_digest_d_A[2] = {
	"128B2FA8BD433C6C068C8D803DFF79792A519A55171B1B650C23661D15897263",
	"771EF3DB" "FF5F1CDC" "32B9C572" "93047619" "1998B2BF" "7CB981D7" "F5B39202" "645F0931",
};

char *info_A[] = {
	"414c" "49434531" "32334059" "41484F4F" "2E434F4D",
	"0090"
};

char *sm2_param_digest_k[2] = {
	"6CB28D99385C175C94F94E934817663FC176D925DD72B727260DBAAE1FB2F96F",
	"36CD79FC" "8E24B735" "7A8A7B4A" "46D454C3" "97703D64" "98158C60" "5399B341" "ADA186D6",
};

char *sm2_param_dh_r_A[2] = {
	"83A2C9C8" "B96E5AF7" "0BD480B4" "72409A9A" "327257F1" "EBB73F5B" "073354B2" "48668563",
	"54A3D667" "3FF3A6BD" "6B02EBB1" "64C2A3AF" "6D4A4906" "229D9BFC" "E68CC366" "A2E64BA4",
};

char *sm2_param_dh_r_B[2] = {
	"33FE2194" "0342161C" "55619C4A" "0C060293" "D543C80A" "F19748CE" "176D8347" "7DE71C80",
	"1F219333" "87BEF781" "D0A8F7FD" "708C5AE0" "A56EE3F4" "23DBC2FE" "5BDF6F06" "8C53F7AD",
};

char *sm2_param_dh_d_A[2] = {
	"6FCBA2EF" "9AE0AB90" "2BC3BDE3" "FF915D44" "BA4CC78F" "88E2F8E7" "F8996D3B" "8CCEEDEE",
	"4813903D" "254F2C20" "A94BC570" "42384969" "54BB5279" "F861952E" "F2C5298E" "84D2CEAA",
};
char *sm2_param_dh_d_B[2] = {
	"5E35D7D3" "F3C54DBA" "C72E6181" "9E730B01" "9A84208C" "A3A35E4C" "2E353DFC" "CB2A3B53",
	"08F41BAE" "0922F47C" "212803FE" "681AD52B" "9BF28A35" "E1CD0EC2" "73A2CF81" "3E8FD1DC",
};